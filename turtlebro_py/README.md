# turtlebro_py — Python API для робота TurtleBro

Данный пакет предоставляет **простой Python‑интерфейс** для управления роботом TurtleBro и ориентирован на обучение основам Python и робототехники без необходимости изучения ROS на старте.

По стилю и идее библиотека близка к стандартному python модулю `turtle`: пользователь вызывает простые команды, а робот физически выполняет движения и действия.


## Установка

Пакет входит в состав метапакета `turtlebro_extra`.

```bash
cd ~/catkin_ws/src
git clone https://github.com/voltbro/turtlebro_extra
cd ..
catkin_make --pkg=turtlebro_extra
```

После установки на роботе необходимо прошить Arduino‑контроллер Mega2650 для управления светодиодной лентой и кнопками:

```
turtlebro_py/ino/turtlebro_py.ino
```

---

## Быстрый старт

> ⚠️ Пользователь **не запускает ROS вручную** (`rosrun`, `roslaunch` не требуются).
> Все взаимодействие происходит через Python API.

```python
from turtlebro_py import TurtleBro

tb = TurtleBro()
```

### Режим отладки

Отладочный вывод можно включить при запуске Python‑скрипта:

```bash
python my_program.py --debug
python my_program.py -d
```

или

```python
from turtlebro_py import TurtleBro

tb = TurtleBro(1) #debug = 1
```

При включённом debug библиотека выводит диагностические сообщения на экран.

---

## Движение

### Движение вперёд / назад

```python
tb.forward(0.7)   # вперёд на 0.7 м
tb.backward(0.3)  # назад на 0.3 м
```

Аргумент всегда задаётся **положительным числом**.

---

### Повороты

```python
tb.left(90)    # поворот влево на 90°
tb.right(90)   # поворот вправо на 90°
```
- поддерживаются углы **больше 180°**;


---

### Переезд в точку

```python
tb.goto(0.5, 1.0)
```

Робот сначала поворачивается в сторону цели, затем едет по прямой.

Координаты задаются в метрах, используется **правило правой руки**.

---

## Координаты робота

```python
x, y = tb.coords
```

Возвращает текущие координаты робота относительно точки старта.

---

## Скорость движения

```python
tb.speed("normal")
```

Допустимые значения:

| Значение   | Линейная скорость (м/с) |
|-----------|--------------------------|
| fastest   | 0.17                     |
| fast      | 0.12                     |
| normal    | 0.09                     |
| slow      | 0.04                     |
| slowest   | 0.01                     |

Угловая скорость подбирается автоматически пропорционально линейной.

---

## Светодиоды

```python
tb.color("green")
tb.color("red")
tb.color("off")
```

Доступные цвета:
`red`, `green`, `blue`, `yellow`, `white`, `off`.

---

## Лидар

### Расстояние до препятствия

```python
d = tb.lidar_distance()       # cпереди
d = tb.lidar_distance(90)     # слева
d = tb.lidar_distance(360)    # полный обзор
```

- угол задаётся в градусах;
Вы можете указать аргумент = 360 для команды, тогда робот вернет массив из 360 точек (по одной на градус) расстояний до препятствий вокруг.

```python
ranges = []
ranges = tb.distance(360)
```

---

## Камера

### Сохранение фото

```python
tb.save_photo()
tb.save_photo("my_photo")
```

Фото сохраняется в `/home/pi/`.

### Получение изображения в виде массива numpy

```python
img = tb.photo
```

---

## Звук

### Запись

```python
tb.record()
tb.record(10, "mysound")
```

### Синтез речи

```python
tb.say("Привет!")
```

### Воспроизведение файлов

```python
tb.play(имя_файла)
```

---

## Кнопки

```python
def myfunc():
    print("Hello")

tb.call(myfunc)        # кнопка 24
```

Можно привязывать функции к кнопкам 22–25:

```python
tb.call(myfunc, 25)
```

---

## Ожидание

```python
tb.wait(2)   # задержка 2 секунды
tb.wait()    # бесконечное ожидание
```

---

## Пример: квадрат 20 см с миганием цветами

```python
from turtlebro_py import TurtleBro

tb = TurtleBro()
tb.speed("normal")

tb.color("green")
tb.forward(0.2)
tb.right(90)

tb.color("red")
tb.forward(0.2)
tb.right(90)

tb.color("yellow")
tb.forward(0.2)
tb.right(90)

tb.color("blue")
tb.forward(0.2)
tb.right(90)
```

---

## TurtleNav — автономная навигация

```python
from turtlebro_py import TurtleNav

tn = TurtleNav()
```

Основная команда, которая может использоваться для перемещения робота при помощи автономной навигации это `goto`, для того чтобы робот поехал на точку с координатами `x, y` (в метрах), укажите в качестве аргументов `x` и `y`:
```python
tn.goto(0.5, 1)  #робот поедет на точку с координатами x = 0.5 м, y = 1 м.
```
При расчете координат используется правило правой руки. Обратите внимание, что теперь робот будет ехать по навигационным целям, при этом он, например, будет объезжать препятствия возникающие у него на пути.
Кроме команды `goto`, вы можете использовать остальные команды передвижения (`forward, backward, left, right`) и все остальные команды типа `photo` или `say`

> ⚠️ Для работы навигации соответствующие ROS‑компоненты должны быть **запущены на роботе** 

```bash
roslaunch turtlebro_navigation turtlebro_slam_navigation.launch.
```

---